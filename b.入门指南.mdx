## 入门指南

从零到一创建一个客户管理模块，实现客户资料增删改查。

### 安装

#### MacOS / Linux

在终端下运行一下脚本:

```bash
curl https://www.yaoapps.com/releases/latest/install.sh | sudo bash
```

#### Windows

1. 安装 Cygwin [下载地址](https://cygwin.com/install.html)

2. 在 Cygwin 终端中运行:

```bash
curl https://www.yaoapps.com/releases/latest/install.sh | sudo bash
```

#### Docker (推荐)

1. 安装 Docker [安装并下载 Docker](https://docs.docker.com/get-docker/)

2. 创建并启动容器

```bash
docker run -d -v /your-project-root:/app -p 5099:5099 yaoapps/yao-dev:latest
```

### 开发

#### 1. 创建项目

创建一个空目录，作为项目目录，并使用 `yao init` 命令，对项目目录初始化。

打开命令行终端，**在项目跟录下运行**:

```bash
cd your-project
yao init
```

命令成功执行，将创建以下文件和目录。

```bash
├── yao_modules # 用于存放公共数据模型文件、数业流文件、数据流脚本等
├── apis # 用于存放接口描述文件
├── data # 用于存放应用产生的文件，如图片,PDF等
├── db   # 用于存放 SQLite 数据库文件
│   └── xiang.db
├── flows   # 用于存放数据流描述文件
├── models  # 用于存放数据模型描述文件
├── plugins # 用于存放GRPC插件文件
├── tables  # 用于存放GRPC插件文件
└── ui      # 静态文件服务器文件目录，可以放置自定义前端制品，该目录下文件可通过 http://host:port/文件名称 访问。
```

#### 2. 设计数据模型

设计一张数据表 `customer`，用于存放客户资料数据。数据表结构如下:

| 字段       | 类型       | 长度/参数                  | 默认值  | 说明                      |
| ---------- | ---------- | -------------------------- | ------- | ------------------------- |
| id         | ID         |                            |         | 数据表 ID                 |
| channel_id | bigInteger |                            |         | 客户来源                  |
| name       | string     | 80                         |         | 客户姓名                  |
| company    | string     | 200                        |         | 公司名称                  |
| gender     | integer    |                            | 0       | 性别 0, 未知，1 男，2，女 |
| birthday   | date       |                            |         | 生日                      |
| desc       | text       |                            |         | 简历                      |
| status     | enum       | ["enabled"], ["disabled"], | enabled | 状态                      |

##### 创建数据模型描述文件

在项目 `models` 目录下，创建数据模型描述文件 `customer.mod.yao`

```jsonc
{
  "name": "客户",
  "table": {
    "name": "customer", // 数据库中对应的数据表名称
    "comment": "客户表"
  },
  "columns": [
    {
      "label": "ID",
      "name": "id",
      "type": "ID",
      "comment": "ID"
    },
    {
      "label": "来源",
      "name": "channel_id",
      "type": "bigInteger",
      "comment": "客户来源",
      "nullable": true,
      "index": true
    },
    {
      "label": "客户姓名",
      "name": "name",
      "type": "string",
      "length": 80,
      "comment": "客户姓名",
      "nullable": true,
      "index": true
    },
    {
      "label": "公司名称",
      "name": "company",
      "type": "string",
      "length": 200,
      "comment": "公司全称",
      "nullable": true,
      "index": true
    },
    {
      "label": "性别",
      "name": "gender",
      "type": "integer",
      "comment": "性别",
      "default": 0,
      "index": true
    },
    {
      "label": "生日",
      "name": "birthday",
      "type": "date",
      "comment": "性别",
      "nullable": true,
      "index": true
    },
    {
      "label": "介绍",
      "name": "desc",
      "type": "text",
      "comment": "介绍",
      "nullable": true
    },
    {
      "label": "状态",
      "name": "status",
      "type": "enum",
      "default": "enabled",
      "option": ["enabled", "disabled"],
      "comment": "状态 enabled 开启, disabled 关闭",
      "index": true
    }
  ],
  "option": {
    "timestamps": true, // 自动创建 created_at, updated_at 字段
    "soft_deletes": true // 自动创建 deleted_at 字段
  },
  "values": [
    // 自动创建默认数据集
    {
      "id": 1,
      "name": "张三",
      "company": "yaoapps.com"
    }
  ]
}
```

##### 创建数据表

使用 `yao migrate` 命令创建数据表

打开命令行终端，**在项目跟录下运行**:

```bash
yao migrate
```

可以使用 `yao run` 命令查询数据

打开命令行终端，**在项目跟录下运行**:

```bash
yao run models.customer.find 1
```

#### 3. 编写界面描述

### 部署

#### 1. 部署到云

#### 2. 部署到端

#### 3. 自定义界面

### 进阶

#### 1.自定义 API

#### 2.复杂数据查询

#### 3.使用数据流

#### 4.增加数据看板功能

#### 5.增加飞书登录功能

### 高级

#### 1. 使用 MySQL 数据库

#### 2. 使用 JavaScript 编写处理器

#### 3. 编写处理器插件

#### 4. 分享到创意工坊

### 资源

#### 一键安装脚本

#### Docker 镜像

#### 示例代码

#### Sketch 设计资源

### 常见问题
